<html>
<body>
  <div id='map' style='width: 100%; height: 100%;'>
    <button type="button" onclick="globalMap.setAddingPolygonMode()" style="position: absolute; top: 10px; left: 10px; z-index: 2;">Add polygon</button>
    <button type="button" onclick="globalMap.clearPolygon()" style="position: absolute; top: 40px; left: 10px; z-index: 2;">Remove polygon</button>
  </div>
<link href='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css' rel='stylesheet' />
<link href='./mapbox-webflow.css' rel='stylesheet' />
<script src='./dist/mapbox-webflow.js'></script>

<script>
  coordinates = []
  globalMap = initMap(undefined, (visibleMarkers) => {
    console.log(visibleMarkers);
    var itemsDivs = document.querySelectorAll('.map-card-property-item');
    itemsDivs.forEach((itemDiv) => {
  	  var divSlug = itemDiv.querySelector('.w-script input.jetboost-list-item').value;
  	  if(visibleMarkers.includes(divSlug)) {
  	    itemDiv.style.display = 'block';
  	  } else {
  	    itemDiv.style.display = 'none';
      }
    });
  },
  () => { console.log('Map loaded!'); });
  var newCoords = [
    {lat: 34.13379, long: 31.160781, slug: 1, price: '2,324,423', squareMeters: '34', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2, bathrooms: 3 },
    {lat: 34.282088, long: 32.257386, slug: 2, price: '3324423', squareMeters: '37', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2 },
    {lat: 34.385049, long: 31.355724, slug: 3, price: '4324423', squareMeters: '38', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bathrooms: 3},
    {lat: 34.414208, long: 31.408244, slug: 4, price: '5324423', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254'},
    {lat: 34.511402, long: 32.551693, slug: 5, price: 6324423, squareMeters: '343', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2, bathrooms: 3},
    {lat: 34.511402, long: 32.551693, slug: 5, price: 6324423, squareMeters: '343', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2, bathrooms: 3},
    {lat: 34.511402, long: 32.551693, slug: 5, price: 6324423, squareMeters: '343', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2, bathrooms: 3},
    {lat: 34.511402, long: 32.551693, slug: 5, price: 6324423, squareMeters: '343', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2, bathrooms: 3},
    {lat: 34.511402, long: 32.551693, slug: 5, price: 6324423, squareMeters: '343', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2, bathrooms: 3},
    {lat: 34.511402, long: 32.551693, slug: 5, price: 6324423, squareMeters: '343', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2, bathrooms: 3},
    {lat: 34.511402, long: 32.551693, slug: 5, price: 6324423, squareMeters: '343', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2, bathrooms: 3},
    {lat: 34.511402, long: 32.551693, slug: 5, price: 6324423, squareMeters: '343', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2, bathrooms: 3},
    {lat: 34.511402, long: 32.551693, slug: 5, price: 6324423, squareMeters: '343', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2, bathrooms: 3},
    {lat: 34.511402, long: 32.551693, slug: 5, price: 6324423, squareMeters: '343', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2, bathrooms: 3},
    {lat: 34.511402, long: 32.551693, slug: 5, price: 6324423, squareMeters: '343', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2, bathrooms: 3},
    {lat: 34.511402, long: 32.551693, slug: 5, price: 6324423, squareMeters: '343', imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254', bedrooms: 2, bathrooms: 3},
    {slug: 6, price: 6324423, imageUrl: 'https://picsum.photos/id/11/10/6', address: 'הגדוד העברי 57', objectUrl: 'https://getplace-new.webflow.io/properties/967269894254'},
  ];
  globalMap.changeObjectsList(newCoords);

  setInterval(() => { 
    const randomId = Math.round(Math.random() * 4 + 1);
    globalMap.highlightObjectWithId(randomId);
  }, 1000)
</script>
</body>
</html>